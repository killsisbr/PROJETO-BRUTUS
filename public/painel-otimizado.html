<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Painel Otimizado - Restaurante</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="/socket.io/socket.io.js"></script>
  <style>
    :root {
      --primary: #667eea;
      --secondary: #764ba2;
      --success: #10b981;
      --info: #3b82f6;
      --warning: #f59e0b;
      --danger: #ef4444;
      --dark: #1e293b;
      --light: #f8fafc;
      --sidebar-width: 280px;
      --header-height: 70px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
      color: #fff;
      min-height: 100vh;
      display: flex;
    }

    /* Sidebar */
    .sidebar {
      width: var(--sidebar-width);
      background: rgba(30, 41, 59, 0.95);
      backdrop-filter: blur(20px);
      border-right: 1px solid rgba(255, 255, 255, 0.1);
      padding: 20px 0;
      display: flex;
      flex-direction: column;
      height: 100vh;
      position: fixed;
      z-index: 1000;
    }

    .logo {
      text-align: center;
      padding: 0 20px 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      margin-bottom: 20px;
    }

    .logo h1 {
      font-size: 1.5rem;
      background: linear-gradient(135deg, #ffffff 0%, #f0f9ff 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .logo p {
      font-size: 0.8rem;
      opacity: 0.7;
      margin-top: 5px;
    }

    .nav-menu {
      flex: 1;
      overflow-y: auto;
    }

    .nav-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 15px 20px;
      margin: 5px 15px;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      color: rgba(255, 255, 255, 0.8);
    }

    .nav-item:hover {
      background: rgba(255, 255, 255, 0.1);
      color: #fff;
    }

    .nav-item.active {
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: #fff;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    }

    .nav-item i {
      font-size: 1.2rem;
      width: 24px;
      text-align: center;
    }

    .sidebar-footer {
      padding: 20px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      text-align: center;
    }

    .sidebar-footer p {
      font-size: 0.8rem;
      opacity: 0.7;
    }

    /* Main Content */
    .main-content {
      flex: 1;
      margin-left: var(--sidebar-width);
      padding: 20px;
      min-height: 100vh;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 0;
      margin-bottom: 30px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .header h2 {
      font-size: 2rem;
      font-weight: 700;
      background: linear-gradient(135deg, #ffffff 0%, #f0f9ff 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .header-actions {
      display: flex;
      gap: 15px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 12px 20px;
      border: none;
      border-radius: 12px;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      color: white;
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
      background: rgba(255, 255, 255, 0.25);
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary), var(--secondary));
    }

    .btn-success {
      background: linear-gradient(135deg, var(--success), #059669);
    }

    .btn-info {
      background: linear-gradient(135deg, var(--info), #1d4ed8);
    }

    .btn-warning {
      background: linear-gradient(135deg, var(--warning), #d97706);
    }

    .btn-danger {
      background: linear-gradient(135deg, var(--danger), #dc2626);
    }

    /* Stats Cards */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      padding: 25px;
      text-align: center;
      transition: transform 0.3s ease;
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    }

    .stat-card i {
      font-size: 2.5rem;
      margin-bottom: 15px;
      display: block;
    }

    .stat-card .value {
      font-size: 2.2rem;
      font-weight: 700;
      margin: 10px 0;
      background: linear-gradient(135deg, #ffffff 0%, #f0f9ff 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .stat-card .label {
      font-size: 1.1rem;
      opacity: 0.9;
    }

    .stat-card .trend {
      font-size: 0.9rem;
      margin-top: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
    }

    .trend.up {
      color: var(--success);
    }

    .trend.down {
      color: var(--danger);
    }

    /* Content Sections */
    .content-section {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      padding: 25px;
      margin-bottom: 30px;
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .section-header h3 {
      font-size: 1.5rem;
      font-weight: 600;
    }

    .section-actions {
      display: flex;
      gap: 10px;
    }

    /* Orders Grid */
    .orders-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 20px;
    }

    .order-card {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 12px;
      padding: 20px;
      transition: all 0.3s ease;
    }

    .order-card:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: translateY(-2px);
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
    }

    .order-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      padding-bottom: 15px;
      border-bottom: 1px dashed rgba(255, 255, 255, 0.1);
    }

    .order-title h4 {
      font-size: 1.2rem;
      margin-bottom: 5px;
    }

    .order-title p {
      font-size: 0.9rem;
      opacity: 0.7;
    }

    .order-status {
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
    }

    .status-pending {
      background: rgba(245, 158, 11, 0.2);
      color: #f59e0b;
      border: 1px solid rgba(245, 158, 11, 0.3);
    }

    .status-processing {
      background: rgba(59, 130, 246, 0.2);
      color: #3b82f6;
      border: 1px solid rgba(59, 130, 246, 0.3);
    }

    .status-ready {
      background: rgba(16, 185, 129, 0.2);
      color: #10b981;
      border: 1px solid rgba(16, 185, 129, 0.3);
    }

    .order-items {
      margin-bottom: 15px;
    }

    .order-item {
      display: flex;
      justify-content: space-between;
      padding: 8px 0;
      border-bottom: 1px dashed rgba(255, 255, 255, 0.05);
    }

    .order-item:last-child {
      border-bottom: none;
    }

    .order-total {
      display: flex;
      justify-content: space-between;
      padding-top: 15px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      font-weight: 600;
      font-size: 1.1rem;
    }

    .order-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .order-actions .btn {
      flex: 1;
      padding: 10px;
      font-size: 0.9rem;
    }

    /* Search and Filters */
    .search-filters {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .search-box {
      position: relative;
      flex: 1;
      min-width: 250px;
    }

    .search-box input {
      width: 100%;
      padding: 14px 20px 14px 45px;
      border: 2px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.1);
      color: white;
      font-size: 16px;
    }

    .search-box input:focus {
      outline: none;
      border-color: var(--primary);
      background: rgba(255, 255, 255, 0.15);
    }

    .search-box i {
      position: absolute;
      left: 16px;
      top: 50%;
      transform: translateY(-50%);
      color: rgba(255, 255, 255, 0.7);
      font-size: 18px;
    }

    .filter-select {
      padding: 14px 20px;
      border: 2px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.1);
      color: white;
      font-size: 16px;
      min-width: 180px;
    }

    .filter-select:focus {
      outline: none;
      border-color: var(--primary);
      background: rgba(255, 255, 255, 0.15);
    }

    /* Responsive */
    @media (max-width: 1024px) {
      .sidebar {
        width: 80px;
      }
      
      .sidebar .logo h1,
      .sidebar .logo p,
      .nav-item span {
        display: none;
      }
      
      .nav-item {
        justify-content: center;
        padding: 15px;
        margin: 5px 10px;
      }
      
      .main-content {
        margin-left: 80px;
      }
    }

    @media (max-width: 768px) {
      .sidebar {
        width: 100%;
        height: auto;
        position: relative;
        flex-direction: row;
        padding: 10px;
      }
      
      .logo {
        padding: 0 15px;
        border-bottom: none;
        border-right: 1px solid rgba(255, 255, 255, 0.1);
        margin-bottom: 0;
        margin-right: 15px;
      }
      
      .nav-menu {
        display: flex;
        overflow-x: auto;
        flex: 1;
      }
      
      .nav-item {
        margin: 0 5px;
        padding: 12px;
        flex-direction: column;
        gap: 5px;
        font-size: 0.8rem;
      }
      
      .sidebar-footer {
        display: none;
      }
      
      .main-content {
        margin-left: 0;
        padding: 15px;
      }
      
      .header {
        flex-direction: column;
        gap: 15px;
        text-align: center;
      }
      
      .header-actions {
        width: 100%;
        justify-content: center;
      }
      
      .stats-grid {
        grid-template-columns: 1fr;
      }
      
      .orders-grid {
        grid-template-columns: 1fr;
      }
    }

    /* Toast Notifications */
    .toast-container {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 9999;
    }

    .toast {
      background: rgba(30, 41, 59, 0.95);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 12px;
      padding: 15px 20px;
      margin-bottom: 10px;
      color: white;
      display: flex;
      align-items: center;
      gap: 10px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      animation: slideIn 0.3s ease;
      min-width: 300px;
    }

    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    .toast.success {
      border-left: 4px solid var(--success);
    }

    .toast.error {
      border-left: 4px solid var(--danger);
    }

    .toast.info {
      border-left: 4px solid var(--info);
    }

    .toast.warning {
      border-left: 4px solid var(--warning);
    }

    /* Loading Spinner */
    .spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255, 255, 255, 0.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: rgba(255, 255, 255, 0.6);
    }

    .empty-state i {
      font-size: 3rem;
      margin-bottom: 20px;
      opacity: 0.5;
    }

    .empty-state h3 {
      font-size: 1.5rem;
      margin-bottom: 10px;
    }

    .empty-state p {
      font-size: 1rem;
      max-width: 500px;
      margin: 0 auto;
    }
  </style>
</head>
<body>
  <!-- Sidebar -->
  <div class="sidebar">
    <div class="logo">
      <h1><i class="fas fa-utensils"></i> Restaurante</h1>
      <p>Painel Administrativo</p>
    </div>
    
    <div class="nav-menu">
      <a href="#" class="nav-item active" data-view="dashboard">
        <i class="fas fa-chart-line"></i>
        <span>Dashboard</span>
      </a>
      <a href="#" class="nav-item" data-view="orders">
        <i class="fas fa-shopping-cart"></i>
        <span>Pedidos</span>
      </a>
      <a href="#" class="nav-item" data-view="menu">
        <i class="fas fa-book"></i>
        <span>Cardápio</span>
      </a>
      <a href="#" class="nav-item" data-view="customers">
        <i class="fas fa-users"></i>
        <span>Clientes</span>
      </a>
      <a href="#" class="nav-item" data-view="messages">
        <i class="fas fa-comments"></i>
        <span>Mensagens</span>
      </a>
      <a href="#" class="nav-item" data-view="database">
        <i class="fas fa-database"></i>
        <span>Banco de Dados</span>
      </a>
      <a href="#" class="nav-item" data-view="settings">
        <i class="fas fa-cog"></i>
        <span>Configurações</span>
      </a>
    </div>
    
    <div class="sidebar-footer">
      <p>v2.0.0</p>
      <p>© 2024 Restaurante</p>
    </div>
  </div>
  
  <!-- Main Content -->
  <div class="main-content">
    <div class="header">
      <h2><i class="fas fa-chart-line"></i> Dashboard</h2>
      <div class="header-actions">
        <button class="btn btn-primary" id="btn-refresh">
          <i class="fas fa-sync-alt"></i> Atualizar
        </button>
        <button class="btn btn-info" id="btn-whatsapp">
          <i class="fab fa-whatsapp"></i> WhatsApp
        </button>
        <button class="btn btn-danger" id="btn-logout">
          <i class="fas fa-sign-out-alt"></i> Sair
        </button>
      </div>
    </div>
    
    <!-- Stats Cards -->
    <div class="stats-grid">
      <div class="stat-card">
        <i class="fas fa-shopping-cart"></i>
        <div class="value" id="total-orders">0</div>
        <div class="label">Pedidos Hoje</div>
        <div class="trend up">
          <i class="fas fa-arrow-up"></i> 12% desde ontem
        </div>
      </div>
      
      <div class="stat-card">
        <i class="fas fa-money-bill-wave"></i>
        <div class="value" id="total-revenue">R$ 0,00</div>
        <div class="label">Receita Hoje</div>
        <div class="trend up">
          <i class="fas fa-arrow-up"></i> 8% desde ontem
        </div>
      </div>
      
      <div class="stat-card">
        <i class="fas fa-users"></i>
        <div class="value" id="active-customers">0</div>
        <div class="label">Clientes Ativos</div>
        <div class="trend down">
          <i class="fas fa-arrow-down"></i> 3% desde ontem
        </div>
      </div>
      
      <div class="stat-card">
        <i class="fas fa-truck"></i>
        <div class="value" id="pending-deliveries">0</div>
        <div class="label">Entregas Pendentes</div>
        <div class="trend">
          <i class="fas fa-equals"></i> 0% desde ontem
        </div>
      </div>
    </div>
    
    <!-- Recent Orders -->
    <div class="content-section">
      <div class="section-header">
        <h3><i class="fas fa-history"></i> Pedidos Recentes</h3>
        <div class="section-actions">
          <button class="btn btn-success" id="btn-new-order">
            <i class="fas fa-plus"></i> Novo Pedido
          </button>
        </div>
      </div>
      
      <div class="search-filters">
        <div class="search-box">
          <i class="fas fa-search"></i>
          <input type="text" id="search-orders" placeholder="Buscar pedidos...">
        </div>
        <select class="filter-select" id="filter-status">
          <option value="">Todos os Status</option>
          <option value="pending">Pendente</option>
          <option value="processing">Em Preparo</option>
          <option value="ready">Pronto</option>
          <option value="delivered">Entregue</option>
        </select>
      </div>
      
      <div class="orders-grid" id="orders-container">
        <div class="empty-state">
          <i class="fas fa-inbox"></i>
          <h3>Nenhum pedido encontrado</h3>
          <p>Comece criando um novo pedido ou aguarde novos pedidos dos clientes.</p>
        </div>
      </div>
    </div>
    
    <!-- Quick Actions -->
    <div class="content-section">
      <div class="section-header">
        <h3><i class="fas fa-bolt"></i> Ações Rápidas</h3>
      </div>
      
      <div class="stats-grid">
        <div class="stat-card">
          <i class="fas fa-print"></i>
          <div class="value">Imprimir</div>
          <div class="label">Pedidos Finalizados</div>
        </div>
        
        <div class="stat-card">
          <i class="fas fa-box-open"></i>
          <div class="value">Entregues</div>
          <div class="label">Pedidos Hoje</div>
        </div>
        
        <div class="stat-card">
          <i class="fas fa-sync"></i>
          <div class="value">Sincronizar</div>
          <div class="label">Cardápio</div>
        </div>
        
        <div class="stat-card">
          <i class="fas fa-chart-bar"></i>
          <div class="value">Relatórios</div>
          <div class="label">Financeiros</div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Toast Container -->
  <div class="toast-container" id="toast-container"></div>
  
  <script>
    // Inicialização do Socket.IO
    const socket = io();
    
    // Elementos DOM
    const navItems = document.querySelectorAll('.nav-item');
    const mainContent = document.querySelector('.main-content');
    const btnRefresh = document.getElementById('btn-refresh');
    const btnWhatsapp = document.getElementById('btn-whatsapp');
    const btnLogout = document.getElementById('btn-logout');
    const btnNewOrder = document.getElementById('btn-new-order');
    const searchOrders = document.getElementById('search-orders');
    const filterStatus = document.getElementById('filter-status');
    const ordersContainer = document.getElementById('orders-container');
    const toastContainer = document.getElementById('toast-container');
    
    // Dados em memória
    let ordersData = [];
    let currentView = 'dashboard';
    
    // Inicialização
    document.addEventListener('DOMContentLoaded', () => {
      initializeApp();
      setupEventListeners();
      loadDashboardData();
    });
    
    // Função de inicialização
    function initializeApp() {
      // Conectar ao WebSocket
      setupSocketConnection();
      
      // Carregar dados iniciais
      loadOrders();
    }
    
    // Configuração da conexão WebSocket
    function setupSocketConnection() {
      socket.on('connect', () => {
        showToast('Conectado ao servidor', 'success');
      });
      
      socket.on('disconnect', () => {
        showToast('Desconectado do servidor', 'warning');
      });
      
      socket.on('initial', (data) => {
        console.log('Dados iniciais recebidos:', data);
        if (data && data.carrinhos) {
          ordersData = Object.values(data.carrinhos);
          renderOrders();
        }
      });
      
      socket.on('carrinho:update', (data) => {
        console.log('Atualização de carrinho recebida:', data);
        updateOrderInList(data);
        renderOrders();
      });
    }
    
    // Configuração dos event listeners
    function setupEventListeners() {
      // Navegação
      navItems.forEach(item => {
        item.addEventListener('click', (e) => {
          e.preventDefault();
          const view = item.dataset.view;
          changeView(view);
        });
      });
      
      // Botões de ação
      btnRefresh.addEventListener('click', refreshData);
      btnWhatsapp.addEventListener('click', openWhatsappQR);
      btnLogout.addEventListener('click', logout);
      btnNewOrder.addEventListener('click', createNewOrder);
      
      // Filtros
      searchOrders.addEventListener('input', filterOrders);
      filterStatus.addEventListener('change', filterOrders);
    }
    
    // Função para mudar de view
    function changeView(view) {
      // Atualizar navegação ativa
      navItems.forEach(item => {
        item.classList.remove('active');
        if (item.dataset.view === view) {
          item.classList.add('active');
        }
      });
      
      // Atualizar título
      const titles = {
        'dashboard': 'Dashboard',
        'orders': 'Gerenciamento de Pedidos',
        'menu': 'Gerenciamento do Cardápio',
        'customers': 'Gerenciamento de Clientes',
        'messages': 'Gerenciamento de Mensagens',
        'database': 'Gerenciamento do Banco de Dados',
        'settings': 'Configurações do Sistema'
      };
      
      document.querySelector('.header h2').innerHTML = 
        `<i class="fas fa-${getViewIcon(view)}"></i> ${titles[view] || view}`;
      
      currentView = view;
      
      // Carregar dados específicos da view
      switch(view) {
        case 'dashboard':
          loadDashboardData();
          break;
        case 'orders':
          loadOrders();
          break;
        case 'menu':
          loadMenu();
          break;
        case 'customers':
          loadCustomers();
          break;
        case 'messages':
          loadMessages();
          break;
        case 'database':
          loadDatabase();
          break;
        case 'settings':
          loadSettings();
          break;
      }
    }
    
    // Função para obter ícone da view
    function getViewIcon(view) {
      const icons = {
        'dashboard': 'chart-line',
        'orders': 'shopping-cart',
        'menu': 'book',
        'customers': 'users',
        'messages': 'comments',
        'database': 'database',
        'settings': 'cog'
      };
      return icons[view] || 'circle';
    }
    
    // Função para carregar dados do dashboard
    async function loadDashboardData() {
      try {
        // Carregar estatísticas
        const statsResponse = await fetch('/api/estatisticas');
        const statsData = await statsResponse.json();
        
        if (statsData) {
          document.getElementById('total-orders').textContent = statsData.pedidosHoje || 0;
          document.getElementById('total-revenue').textContent = 
            `R$ ${(statsData.totalMensagens || 0).toFixed(2).replace('.', ',')}`;
          document.getElementById('active-customers').textContent = statsData.usuariosAtivos || 0;
          document.getElementById('pending-deliveries').textContent = 0; // Implementar
        }
        
        // Carregar pedidos recentes
        loadOrders();
      } catch (error) {
        console.error('Erro ao carregar dados do dashboard:', error);
        showToast('Erro ao carregar dados do dashboard', 'error');
      }
    }
    
    // Função para carregar pedidos
    async function loadOrders() {
      try {
        // Em um sistema real, isso viria da API
        // Por enquanto, vamos simular dados
        const mockOrders = [
          {
            id: '5511999999999',
            customer: 'João Silva',
            items: [
              { name: 'X-Burger', quantity: 2, price: 25.00 },
              { name: 'Coca-Cola', quantity: 1, price: 8.00 }
            ],
            total: 58.00,
            status: 'processing',
            time: '14:30'
          },
          {
            id: '5511888888888',
            customer: 'Maria Santos',
            items: [
              { name: 'X-Salada', quantity: 1, price: 22.00 },
              { name: 'Batata Frita', quantity: 1, price: 12.00 }
            ],
            total: 34.00,
            status: 'ready',
            time: '14:25'
          },
          {
            id: '5511777777777',
            customer: 'Carlos Oliveira',
            items: [
              { name: 'X-Frango', quantity: 1, price: 20.00 },
              { name: 'Suco de Laranja', quantity: 2, price: 6.00 }
            ],
            total: 32.00,
            status: 'pending',
            time: '14:20'
          }
        ];
        
        ordersData = mockOrders;
        renderOrders();
      } catch (error) {
        console.error('Erro ao carregar pedidos:', error);
        showToast('Erro ao carregar pedidos', 'error');
      }
    }
    
    // Função para renderizar pedidos
    function renderOrders() {
      if (ordersData.length === 0) {
        ordersContainer.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-inbox"></i>
            <h3>Nenhum pedido encontrado</h3>
            <p>Comece criando um novo pedido ou aguarde novos pedidos dos clientes.</p>
          </div>
        `;
        return;
      }
      
      const filteredOrders = filterOrdersData();
      
      if (filteredOrders.length === 0) {
        ordersContainer.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-filter"></i>
            <h3>Nenhum pedido encontrado</h3>
            <p>Nenhum pedido corresponde aos filtros aplicados.</p>
          </div>
        `;
        return;
      }
      
      ordersContainer.innerHTML = filteredOrders.map(order => `
        <div class="order-card">
          <div class="order-header">
            <div class="order-title">
              <h4>${order.customer}</h4>
              <p>ID: ${order.id} • ${order.time}</p>
            </div>
            <div class="order-status status-${order.status}">
              ${getStatusText(order.status)}
            </div>
          </div>
          
          <div class="order-items">
            ${order.items.map(item => `
              <div class="order-item">
                <span>${item.quantity}x ${item.name}</span>
                <span>R$ ${(item.quantity * item.price).toFixed(2).replace('.', ',')}</span>
              </div>
            `).join('')}
          </div>
          
          <div class="order-total">
            <span>Total:</span>
            <span>R$ ${order.total.toFixed(2).replace('.', ',')}</span>
          </div>
          
          <div class="order-actions">
            <button class="btn btn-info" onclick="viewOrder('${order.id}')">
              <i class="fas fa-eye"></i> Ver
            </button>
            <button class="btn btn-success" onclick="processOrder('${order.id}')">
              <i class="fas fa-check"></i> Processar
            </button>
            <button class="btn btn-danger" onclick="cancelOrder('${order.id}')">
              <i class="fas fa-times"></i> Cancelar
            </button>
          </div>
        </div>
      `).join('');
    }
    
    // Função para filtrar pedidos
    function filterOrdersData() {
      const searchTerm = searchOrders.value.toLowerCase();
      const statusFilter = filterStatus.value;
      
      return ordersData.filter(order => {
        const matchesSearch = !searchTerm || 
          order.customer.toLowerCase().includes(searchTerm) ||
          order.id.includes(searchTerm);
        
        const matchesStatus = !statusFilter || order.status === statusFilter;
        
        return matchesSearch && matchesStatus;
      });
    }
    
    // Função para atualizar um pedido na lista
    function updateOrderInList(orderData) {
      // Implementar lógica de atualização
      console.log('Atualizando pedido:', orderData);
    }
    
    // Funções auxiliares para status
    function getStatusText(status) {
      const statusTexts = {
        'pending': 'Pendente',
        'processing': 'Em Preparo',
        'ready': 'Pronto',
        'delivered': 'Entregue'
      };
      return statusTexts[status] || status;
    }
    
    // Funções de ação
    function refreshData() {
      showToast('Atualizando dados...', 'info');
      switch(currentView) {
        case 'dashboard':
          loadDashboardData();
          break;
        case 'orders':
          loadOrders();
          break;
        default:
          loadDashboardData();
      }
    }
    
    function openWhatsappQR() {
      showToast('Abrindo QR Code do WhatsApp...', 'info');
      // Implementar abertura do modal de QR Code
      window.open('/gerenciar-banco.html', '_blank');
    }
    
    function logout() {
      if (confirm('Tem certeza que deseja sair?')) {
        showToast('Saindo do sistema...', 'info');
        // Implementar logout real
        setTimeout(() => {
          window.location.href = '/';
        }, 1000);
      }
    }
    
    function createNewOrder() {
      showToast('Criando novo pedido...', 'info');
      // Implementar criação de novo pedido
    }
    
    function viewOrder(orderId) {
      showToast(`Visualizando pedido ${orderId}`, 'info');
      // Implementar visualização detalhada do pedido
    }
    
    function processOrder(orderId) {
      showToast(`Processando pedido ${orderId}`, 'success');
      // Implementar processamento do pedido
    }
    
    function cancelOrder(orderId) {
      if (confirm(`Tem certeza que deseja cancelar o pedido ${orderId}?`)) {
        showToast(`Pedido ${orderId} cancelado`, 'warning');
        // Implementar cancelamento do pedido
      }
    }
    
    // Funções para carregar outras views (placeholders)
    function loadMenu() {
      showToast('Carregando gerenciamento de cardápio...', 'info');
    }
    
    function loadCustomers() {
      showToast('Carregando gerenciamento de clientes...', 'info');
    }
    
    function loadMessages() {
      showToast('Carregando gerenciamento de mensagens...', 'info');
    }
    
    function loadDatabase() {
      showToast('Carregando gerenciamento do banco de dados...', 'info');
      window.open('/gerenciar-banco.html', '_blank');
    }
    
    function loadSettings() {
      showToast('Carregando configurações do sistema...', 'info');
    }
    
    // Função para mostrar notificações
    function showToast(message, type = 'info') {
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      
      const icon = {
        'success': 'fa-check-circle',
        'error': 'fa-exclamation-circle',
        'warning': 'fa-exclamation-triangle',
        'info': 'fa-info-circle'
      }[type] || 'fa-info-circle';
      
      toast.innerHTML = `
        <i class="fas ${icon}"></i>
        <span>${message}</span>
      `;
      
      toastContainer.appendChild(toast);
      
      // Remover toast após 3 segundos
      setTimeout(() => {
        toast.style.animation = 'slideOut 0.3s ease';
        setTimeout(() => {
          if (toast.parentNode) {
            toast.parentNode.removeChild(toast);
          }
        }, 300);
      }, 3000);
    }
    
    // Funções para filtros em tempo real
    function filterOrders() {
      renderOrders();
    }
    
    // Adicionar estilos para animação de saída
    const style = document.createElement('style');
    style.textContent = `
      @keyframes slideOut {
        from {
          transform: translateX(0);
          opacity: 1;
        }
        to {
          transform: translateX(100%);
          opacity: 0;
        }
      }
    `;
    document.head.appendChild(style);
  </script>
</body>
</html>